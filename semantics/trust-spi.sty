%% Standard formatting commands for crypto primitives and trust
%% relationships.

\usepackage{amsmath}
\usepackage{semantic}

\newcommand{\crypt}[2]{\ensuremath{\{#1\}_{#2}}}
\newcommand{\hash}[1]{\ensuremath{|#1|}}
\newcommand{\extend}[2]{\ensuremath{#1\mid#2}}
\newcommand{\encrypt}[2]{\ensuremath{\{#1\}_{\public{#2}}}}
\newcommand{\decrypt}[2]{\ensuremath{\{#1\}_{\private{#2}}}}
\newcommand{\sign}[2]{\ensuremath{\{|#1|\}_{\private{#2}}}}
\newcommand{\design}[2]{\ensuremath{\{|#1|\}_{\public{#2}}}}
\newcommand{\cert}[2]{\ensuremath{[[#1]]_{#2}}}
\newcommand{\evidence}[2]{\ensuremath{\langle #1,\sign{#2}{AIK}\rangle}}
\newcommand{\request}[3]{\ensuremath{\langle #1,#2,#3\rangle}}
\newcommand{\proposal}[2]{\ensuremath{ \langle #1,#2\rangle}}
\newcommand{\public}[1]{\ensuremath{#1^{+}}}
\newcommand{\private}[1]{\ensuremath{#1^{-}}}
\newcommand{\seal}[2]{\ensuremath{seal(#1,\{#2\})}}
\newcommand{\wrap}[2]{\ensuremath{wrap(#1,\{#2\})}}

%%% Trust notations (deprecated)

\newcommand{\trustworthy}[1]{\ensuremath{W(#1)}}
\newcommand{\trusts}[2]{\ensuremath{T^{\mathsf{#1}}[\mathsf{#2}]}}
\newcommand{\conf}[3]{\ensuremath{\mathit{C(\mathsf{#1},\mathsf{#2},\{#3\})}}}
\newcommand{\confrest}[2]{\ensuremath{\mathit{C_r(\mathsf{#1},\mathsf{#2})}}}
\newcommand{\integ}[3]{\ensuremath{\mathit{I(\mathsf{#1},\mathsf{#2},\{#3\})}}}
\newcommand{\integrest}[2]{\ensuremath{\mathit{I_r(\mathsf{#1},\mathsf{#2})}}}
\newcommand{\avail}[3]{\ensuremath{\mathit{A(\mathsf{#1},\mathsf{#2},\{#3\})}}}
\newcommand{\availrest}[2]{\ensuremath{\mathit{A_r(\mathsf{#1},\mathsf{#2})}}}
\newcommand{\account}[2]{\ensuremath{\mathit{N(\mathsf{#1},\mathsf{#2})}}}
\newcommand{\provides}[1]{\ensuremath{\mathsf{provides}(#1)}}

%%% Spi notations

\reservestyle{\command}{\textsf}
\command{case,of,let,in,is}

\newcommand{\CASE}{\ensuremath{ \<case> \;}}
\newcommand{\OF}{\ensuremath{\; \<of> \;}}
\newcommand{\LET}{\ensuremath{ \<let> \;}}
\newcommand{\IN}{\ensuremath{\; \<in> \;}}
\newcommand{\IS}{\ensuremath{\; \<is> \;}}

\newcommand{\nil}{\ensuremath{\mathbf{0}}}
\newcommand{\bind}[1]{\ensuremath{\nu #1}}
\newcommand{\snd}[2]{\ensuremath{\overline{#1}\langle#2\rangle}}
\newcommand{\rcv}[2]{\ensuremath{#1(#2)}}
\newcommand{\rep}[1]{\ensuremath{!#1}}
\newcommand{\alt}{\ensuremath{\; + \;}}
\newcommand{\cmp}{\ensuremath{ \mid }}
\newcommand{\ccase}[3]{\ensuremath{\CASE #1 \OF #2 \IN #3}}
\newcommand{\icase}[2]{\ensuremath{\CASE #1 \OF #2}}
\newcommand{\arm}[2]{\ensuremath{\; #1: #2}} 
\newcommand{\llet}[3]{\ensuremath{\LET #1=#2 \IN #3}}
\newcommand{\defs}{\ensuremath{\stackrel{\Delta}{=}}}

%%% Message notation

\newcommand{\sndmsg}[4]{\ensuremath{#1\rightarrow #2:#3}\;
  \mathsf{on}\; #4}