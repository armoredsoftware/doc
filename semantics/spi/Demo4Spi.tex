\documentclass[12pt]{report}
\usepackage{fixltx2e}
\usepackage{amssymb,amsmath}
\usepackage{trust-spi}
\usepackage{demo4Extra}


%\usepackage{syntonly}
%\syntaxonly

%\pagestyle{empty}

\setlength{\parindent}{0.0in}
\setlength{\parskip}{0.125in}







\begin{document}




\title{ArmoredSoftware Demo4}
\author{}%Adam Petz}
\date{\today}

%\maketitle


\section*{ArmoredSoftware Demo4 }




\section*{Spi Calculus Representation: Attempt 1}

\begin{eqnarray*}
 % \label{eq:1}
  \app(R) & \defs & \bind{\nonce{\app}} \snd{\channel{\app \att}}{\req}.\rcv{\channel{\app \att}}{\resp} . F(\req,\resp) 
\\
\\
  %\label{eq:2}
  \att & \defs & \textbf{(}\rcv{\channel{\att \app}}{\evd, \nonce{\app}, \pmask} \comp 
    \snd{\channel{\att \tp}}{m\_id} . \rcv{\channel{\att \tp}}{\public{AIK}, \aikh} \textbf{)} . \\
    & & \snd{\channel{\att \ca}}{(\att, \public{AIK})} . \rcv{\channel{\att \ca}}{\k\textsubscript{cipher}, cert\textsubscript{cipher}} . \\
    & & \snd{\channel{\att \tp}}{act\_id(\aikh, \k\textsubscript{cipher})} . \rcv{\channel{\att \tp}}{\k} . \\
    & & \ccase{\crypt{cert\textsubscript{cipher}}{\k}}{cert}{} \\  %remove last ccase arg?
    & & \snd{\channel{\att \mea}}{\evd} . \rcv{\channel{\att \mea}}{\eve} . \\
    & & \snd{\channel{\att \tp}}{tpm\_quote(\aikh, \pmask, \hash{(\eve, \nonce{\app}, cert)})} . \rcv{\channel{\att \tp}}{\pcomp, qSig} . \\
    & & \snd{\channel{\app \att}}{\eve, \nonce{\app}, cert, \pcomp, qSig} . \att 
\\
\\
  %\label{eq:3}
  \tp & \defs & \bind{AIK, \aikh} \rcv{\channel{\att \tp}}{x} . \tcase{x}{m\_id} \\ %new AIK(pub and pri?)
  & & \snd{\channel{\att \tp}}{\public{AIK}, \aikh} . \\
  & & \rcv{\channel{\att \tp}}{y} . \tcase{y}{act\_id(\aikh, \k\textsubscript{cipher})} \\
  & & \ccase{\decrypt{\k\textsubscript{cipher}}{EK}}{(\k, aik\textsubscript{hash})}{} \\  %use let for pair??
  & & [loaded(\aikh)] . [\hash{pub(\aikh)}\; is \; aik\textsubscript{hash}] . \\
  & & \snd{\channel{\att \tp}}{\k} . \rcv{\channel{\att \tp}}{z} . \\
  & & \tcase{z}{tpm\_quote(\aikh, \pmask, exdata\textsubscript{hash})} \\
  & & \snd{\channel{\att \tp}}{(\pcomp, sig((\hash{\pcomp}, exdata\textsubscript{hash}), \private{AIK})} .\tp
\\
\\
  %\label{eq:4}
  \ca & \defs & \bind{\k, CA} \rcv{\channel{\att \ca}}{x, \public{AIK}} . [lookup(x)] . \llet{\public{EK}} {end(x)}{} \\
  & & \snd{\channel{\att \ca}}{(\encrypt{\k, \hash{AIK}}{EK}, \crypt{\sign{AIK}{CA}}{\k})} . \ca
\\
\\
  %\label{eq:5}
  \mea & \defs & \rcv{\channel{\att \mea}}{d} . \snd{\channel{\att \mea}}{measure(d)} . \mea
\end{eqnarray*}


\newpage
Key: \\
\begin{tabular}{l  l}
\app  :  &  Appraiser\\
\att  :  &  Attestation Agent\\
\tp  :  &  TPM\\
\ca  :  &  Certificate Authority\\
\mea  :  &  Measurer\\
d : & desired evidence \\
e : & gathered evidence \\
\req  :  & Request \\
\resp  :  & Response \\
F:  & appraisal function that evaluates \resp \; based on \req \; and \app's internal standards \\
\nonce{\app} : & nonce generated by \app \\
\pmask : & pcr mask indicating desired pcr registers \\
\pcomp  : & pcr composite structure containing select pcr register values \\
\aikh : & AIK key handle(used by TPM to reference loaded keys) \\
\k : & Session key created by \ca \\
cipher  :  &  as a subscript, this indicates encrypted text(as opposed to plaintext)\\
hash  :  &  as a subscript, this indicates hashed text(like encrypted text, \\ &the plaintext contents cannot be discovered directly)\\
loaded(H)  :  &  takes a key handle H as input, and is successful if H is loaded in the TPM\\
pub(H)  :  &  takes a key handle H(of a loaded key) as input, \\ & and returns the associated Public Key\\
sig(data, key)  :  &  signs (the hash of) data with key and returns the signature\\
lookup(ID)  :  & takes an identity(ID) as input, and is successful if the local id $\rightarrow$ EK table \\ &
has an EK associated with ID  \\
end(ID)  :  &  takes an identity(ID) as input and returns the associated public EK \\
\end{tabular}

Note:  In our current implementation, channels C\textsubscript{XY} and C\textsubscript{YX} are equivalent for any two parties X, Y.














\end{document}
